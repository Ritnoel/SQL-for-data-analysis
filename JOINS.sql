--inner join
--left join
--right join
--outer join/full join/full outer join
--cross join
--natural join
--self join
--union


CREATE TABLE Employeees(
EMP_ID NVARCHAR(MAX),
EMP_NAME VARCHAR(20),
SALARY INT,
DEPT_ID NVARCHAR(MAX),
MANAGER_ID NVARCHAR(MAX),
)


INSERT INTO Employeees 
VALUES ('E1', 'chiamaka', 1500, 'D1', 'M1');

INSERT INTO Employeees 
VALUES ('E2', 'Aliyu', 3000, 'D2', 'M2');

INSERT INTO Employeees 
VALUES ('E3', 'chegede', 4000, 'D3', 'M3');

INSERT INTO Employeees 
VALUES ('E4', 'esther', 7000, 'D4', 'M4');

INSERT INTO Employeees 
VALUES ('E5', 'omolaso', 1500, 'D5', 'M5');


CREATE TABLE Manager(
MANAGER_ID NVARCHAR(MAX),
MANAGER_NAME VARCHAR(20),
DEPT_ID NVARCHAR(MAX),
)

INSERT INTO Manager
VALUES ('M1', 'Lubabat', 'D1');

INSERT INTO Manager
VALUES ('M2', 'abigail', 'D2');

INSERT INTO Manager
VALUES ('M3', 'ikrama', 'D3');

INSERT INTO Manager
VALUES ('M4', 'muhammed', 'D4');


CREATE TABLE Department(
DEPT_ID NVARCHAR(MAX),
DEPT_NAME VARCHAR(20)
)

INSERT INTO Department
VALUES ('D1', 'HR');

INSERT INTO Department
VALUES ('D2', 'MAINTENANCE');

INSERT INTO Department
VALUES ('D3', 'SALES');

INSERT INTO Department
VALUES ('D4', 'CUSTOMER_SERVICE');


CREATE TABLE Project(
PROJECT_ID NVARCHAR(MAX),
PROJECT_NAME VARCHAR(20),
TEAM_MEMBER_ID NVARCHAR(MAX)
)

INSERT INTO Project
VALUES ('P1', 'GENDER EQUALITY', 'E1');

INSERT INTO Project
VALUES ('P1', 'GENDER EQUALITY', 'E2');

INSERT INTO Project
VALUES ('P1', 'GENDER EQUALITY', 'M3');

INSERT INTO Project
VALUES ('P2', 'CANCER AWARENESS', 'E1');

INSERT INTO Project
VALUES ('P2', 'CANCER AWARENESS', 'M4');

select * from Employeees
select * from Manager
select * from Department
select * from Project

--INNER JOIN
SELECT *
FROM Employeees as E
INNER JOIN Department as D
ON E.DEPT_ID = D.DEPT_ID;


--GET ALL DETAILS OF EMPLOYEES, THEIR MANAGERS, DEPT AND PROJECTS WORKING ON
--LEFT JOIN
SELECT *
FROM Employeees E
LEFT JOIN Department D 
ON E.DEPT_ID = D.DEPT_ID
INNER JOIN Manager M 
ON M.MANAGER_ID = E.MANAGER_ID
LEFT JOIN Project P
ON P.TEAM_MEMBER_ID = E.EMP_ID;


SELECT E.EMP_NAME, D.DEPT_NAME, M.MANAGER_NAME, P.PROJECT_NAME
FROM Employeees E
LEFT JOIN Department D 
ON E.DEPT_ID = D.DEPT_ID
INNER JOIN Manager M 
ON M.MANAGER_ID = E.MANAGER_ID
LEFT JOIN Project P
ON P.TEAM_MEMBER_ID = E.EMP_ID;


SELECT E.EMP_NAME, D.DEPT_NAME, M.MANAGER_NAME, P.PROJECT_NAME
FROM Employeees E
INNER JOIN Department D 
ON E.DEPT_ID = D.DEPT_ID
INNER JOIN Manager M 
ON M.MANAGER_ID = E.MANAGER_ID
INNER JOIN Project P
ON P.TEAM_MEMBER_ID = E.EMP_ID;


SELECT E.EMP_NAME, D.DEPT_NAME, M.MANAGER_NAME, P.PROJECT_NAME
FROM Employeees E
RIGHT JOIN Department D 
ON E.DEPT_ID = D.DEPT_ID
INNER JOIN Manager M 
ON M.MANAGER_ID = E.MANAGER_ID
RIGHT JOIN Project P
ON P.TEAM_MEMBER_ID = E.EMP_ID;

--FULL JOIN
SELECT *
FROM Employeees E
FULL JOIN Department D
ON E.DEPT_ID = D.DEPT_ID;


SELECT E.EMP_NAME,D.DEPT_NAME
FROM Employeees E
FULL JOIN Department D
ON E.DEPT_ID = D.DEPT_ID;


--CROSS JOIN
SELECT E.EMP_NAME, D.DEPT_NAME
FROM Employeees E
CROSS JOIN Department D;


CREATE TABLE Company(
COMPANY_ID NVARCHAR(MAX),
COMPANY_NAME VARCHAR(20),
LOCATION VARCHAR(20)
)


INSERT INTO Company
VALUES ('C1', 'TECH4DEV', 'Lagos');

SELECT * FROM Company

SELECT E.EMP_NAME, D.DEPT_NAME, C.COMPANY_NAME, C.LOCATION
FROM Employeees E
INNER JOIN Department D
ON E.DEPT_ID = D.DEPT_ID
CROSS JOIN Company C;


--NATURAL JOIN
--SELECT E.EMP_ID, D.DEPT_NAME
--FROM Employeees E
--NATURAL JOIN Department D;

--SELF JOIN
CREATE TABLE tech4dev_FAMILY(
MEMBER_ID NVARCHAR(MAX),
NAME VARCHAR(20),
AGE INT,
PARENT_ID NVARCHAR(MAX)
)

INSERT INTO tech4dev_FAMILY 
VALUES ('F1', 'ESTHER', 45, 'F5');

INSERT INTO tech4dev_FAMILY 
VALUES ('F2', 'ABDUL', 45, 'F5');

INSERT INTO tech4dev_FAMILY 
VALUES ('F3', 'MARY', 45, 'F5');

INSERT INTO tech4dev_FAMILY 
VALUES ('F4', 'JUMMAI', 45, '');

INSERT INTO tech4dev_FAMILY 
VALUES ('F5', 'ALIYU', 45, 'F6');

INSERT INTO tech4dev_FAMILY 
VALUES ('F6', 'CHIAMAKA', 45, '');

INSERT INTO tech4dev_FAMILY 
VALUES ('F7', 'LOVE', 45, 'F4');

INSERT INTO tech4dev_FAMILY 
VALUES ('F8', 'MARYAM', 45, 'F4');

SELECT * FROM tech4dev_FAMILY;


SELECT CHILD.NAME AS CHILD_NAME,
		CHILD.AGE AS CHILD_AGE,
		PARENT.NAME AS PARENT_NAME,
		PARENT.AGE AS PARENT_AGE
FROM tech4dev_FAMILY AS CHILD
JOIN tech4dev_FAMILY AS PARENT ON CHILD.PARENT_ID = PARENT.MEMBER_ID


CREATE TABLE TABLE1(
EMPLOYEE_ID NVARCHAR(MAX),
NAME VARCHAR(20),
)

INSERT INTO TABLE1 
VALUES ('A1', 'MARYAM');
INSERT INTO TABLE1 
VALUES ('A2', 'MARY');

CREATE TABLE TABLE2(
EMPLOYEE_ID NVARCHAR(MAX),
NAME VARCHAR(20),
)

INSERT INTO TABLE2 
VALUES ('B1', 'MOSES');
INSERT INTO TABLE1 
VALUES ('B2', 'IKRAMA');

SELECT *
FROM TABLE1
UNION
SELECT *
FROM TABLE2

